{
 "align_labels_right": 0,
 "creation": "2019-12-21 10:18:18.473650",
 "css": "    .other-pages{\n        page-break-before: always;\n      }\n\n.bgcolor\n{\ncolor: #ffffff !important;\n}\n",
 "custom_format": 1,
 "default_print_language": "en",
 "disabled": 0,
 "doc_type": "TCA Activity",
 "docstatus": 0,
 "doctype": "Print Format",
 "font": "Default",
 "html": "\n{% set wtg_model = [] %}\n{% for item in frappe.get_all(\"WTG Model\", {\"name\":doc.wtg_model}, \"technology,tower_type,hub_height,capacity,wtg_manufacturer\") %} \n        {% if wtg_model.append(item) %}{% endif %}\n{% endfor %}\n{% set tca_schedule = [] %}\n{% for item in frappe.get_all(\"TCA Schedule\", {\"name\":doc.tca_schedule}, \"customer_name,site_name,state\") %} \n        {% if tca_schedule.append(item) %}{% endif %}\n{% endfor %}\n\n<div  id=\"header-html\" class=\"hidden-pdf\" >\n  \n<table width=\"100%\" border=\"1\" style=\"text-align: center\" class=\"bgcolor\">\n<tbody>\n  <tr>\n <td rowspan=\"2\" width=\"25%\" padding: 15px;><br/><br/><img src=\"files/power_logo.png\"></td>\n <td rowspan=\"2\"  style=\"background-color: #397b21 !important;\" align=\"center\" width=\"45%\" ><h4 class=\"bgcolor\"><br/>{{doc.tca_report_name}}</h4>\n</td>\n<td class=\"bgcolor\" style=\"background-color: #397b21 !important;\"><h5 class=\"bgcolor\">Report Ref. No.: <br>{{doc.reference_number}}</h5>\n</td>\n </tr>\n<tr>\n      <td class=\"bgcolor\" style=\"background-color: #397b21 !important;\"><h6 class=\"bgcolor\" >{{doc.wtg_name}}</h6>\n</td>\n  </tr>\n  </tbody>\n</table>\n\n</div>\n\n<table class=\"table table-bordered\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td class=\"bgcolor\" style=\"background-color: #397b21 !important;\"  width=\"20%\">Date of Audit</td>\n\t\t\t<td align=\"right\">{{doc.get_formatted('audit_date') }}</td>\n\t\t</tr>\n</tbody>\n</table>\n\n<table class=\"table table-bordered\">\n\t<tbody>\n\t\t<tr>\n                        <td rowspan=\"2\" class=\"bgcolor\" style=\"background-color: #397b21 !important;\" width=\"20%\">WTG Location</td>\n\t\t\t<td width=\"15%\">Equipment</td>\n\t\t\t<td width=\"15%\">State</td>\n\t\t\t<td width=\"15%\">Site</td>\n\t\t\t<td width=\"15%\">UIN NO</td>\n\t\t\t<td width=\"20%\">Date of Commissioning</td>\n\t\t</tr>\n\n\n\n                <tr style=\"background-color: #FFFF80 !important;\">\n\n                        <td style=\"background-color: #FFFF80 !important;\">{{doc.wtg_name}}</td>\n\t\t\t<td style=\"background-color: #FFFF80 !important;\">{{tca_schedule[0]['state']}}</td>\n\t\t\t<td style=\"background-color: #FFFF80 !important;\">{{tca_schedule[0]['site_name']}}</td>\t\t\t\n                        <td style=\"background-color: #FFFF80 !important;\">{{doc.uin_no}}</td>\n\t\t\t<td style=\"background-color: #FFFF80 !important;\">{{doc.get_formatted('date_of_commissioning')}}</td>\n</tr>\n</tbody>\n</table>\n\n<table class=\"table table-bordered\">\n\t<tbody>\n\t\t<tr>\n        <td rowspan=\"2\" class=\"bgcolor\" style=\"background-color: #397b21\" width=\"20%\">WTG Details</td>\n\t\t\t<td width=\"15%\">Model</th>\n\t\t\t<td width=\"15%\">MW Capacity</td>\n\t\t\t<td width=\"15%\">Rotor/Blade</td>\n\t\t\t<td width=\"15%\">Technology</td>\n\t\t\t<td width=\"10%\">Tower Type</td>\n                        <td width=\"10%\">Hub Height</td>\n\t\t</tr>\n\n\n                <tr style=\"background-color: #FFFF80 !important;\">\n       \n                        <td style=\"background-color: #FFFF80 !important;\">{{doc.wtg_model}}</td>\n\t\t\t<td style=\"background-color: #FFFF80 !important;\">{{wtg_model[0]['capacity']}}</td>\n                        <td style=\"background-color: #FFFF80 !important;\">{{wtg_model[0]['wtg_manufacturer']}}</td>\n\t\t\t<td style=\"background-color: #FFFF80 !important;\">{{wtg_model[0]['technology']}}</td>\n\t\t\t<td style=\"background-color: #FFFF80 !important;\">{{wtg_model[0]['tower_type']}}</td>\n                        <td style=\"background-color: #FFFF80 !important;\">{{wtg_model[0]['hub_height']}}</td>\n                </tr>\n</tbody>\n</table>\n<table class=\"table table-bordered\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td class=\"bgcolor\" style=\"background-color: #397b21 !important;\" width=\"20%\">Asset Owner</td>\n\t\t\t<td  style=\"background-color: #FFFF80 !important;\" width=\"30%\">{{tca_schedule[0]['customer_name']}}</td>\n\t\t\t<td class=\"bgcolor\" style=\"background-color: #397b21 !important;\" width=\"20%\">Coordinates</td>\n                        <td style=\"background-color: #FFFF80 !important;\" width=\"15%\">{{doc.latitude}}</td>\n                        <td  style=\"background-color: #FFFF80 !important;\" width=\"15%\">{{doc.longitude}}</td>\n\t\t</tr>\n        </tbody>\n</table>\n<table class=\"table table-bordered\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td class=\"bgcolor\" style=\"background-color: #397b21 !important;\" width=\"20%\">WTG KWH</td>\n\t\t\t<td  style=\"background-color: #FFFF80 !important;\" width=\"20%\">{{doc.wtg_kwh}}</td>\n\t\t\t<td class=\"bgcolor\" style=\"background-color: #397b21 !important;\" width=\"30%\">WTG HRS</td>\n                        <td style=\"background-color: #FFFF80 !important;\" width=\"30%\">{{doc.wtg_hrs}}</td>\n\t\t</tr>\n        </tbody>\n</table>\n<table class=\"table table-bordered\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td class=\"bgcolor\" style=\"background-color: #397b21 !important;\" width=\"20%\">Ambient</td>\n\t\t\t<td width=\"20%\">Temp</td>\n\t\t\t<td style=\"background-color: #FFFF80 !important;\" width=\"20%\">{{doc.ambient_temperature}}</td>\n                        <td width=\"20%\">Wind</td>\n                       <td style=\"background-color: #FFFF80 !important;\" width=\"20%\">{{doc.wind_speed}}</td>\n\t\t</tr>\n        </tbody>\n</table>\n<table class=\"table table-bordered\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td rowspan=\"10\" width=\"50%\" style=\"background-color: #FFFF80 !important;\"><br/><strong>Scope:</strong><br/>\nProvide Visual Impressions as Technical Condition\nAudit samples that cover WTG Tower, Nacelle\nincluding all integrated controllers, rotor, control\npanel/s, transformer & WTG civil work periphery.\n<br/>\n<strong>Objective:</strong><br/>\nThe purpose of audit is to gauge overall operational\nhealth status of the turbines with special emphasis on\nturbine\u2019s technical condition, and the aspects affecting\nsafety & longevity of said turbines.<br/><br/></td>\n\n<td rowspan=\"10\"><img src=\"{{doc.turbine_image}}\" height=\"250px\" width =\"300px\"></td>\n\t\t\n</tr>\n        </tbody>\n</table>\n\n<table class=\"table table-bordered\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<th class=\"bgcolor\" style=\"background-color: #397b21 !important;\">Observations under this Audit report are classified to indicate Severity and Attributable cause</th>\n\t\t</tr>\n        </tbody>\n</table>\n<div class=\"row other-pages\"></div>\n<table class=\"table table-bordered\">\n\t<tbody>\n\t\t<tr align=\"center\">\n\t\t\t<td colspan=\"2\" width=\"49%\"><strong>Severity</strong></td>\n                        <td width=\"2%\" rowspan=\"5\"></td>\n                        <td colspan=\"2\"  width=\"49%\"><strong>Attributable cause</strong></td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td width=\"40%\">Unsafe operation affecting WTG/operating\nPersonnel. Requires immediate stop till\nRepair are undertaken.</td>\n                        <td width=\"9%\"  style =\"color:#FF0000!important;\">Critical</td>  \n                        <td width=\"42%\">Workmanship & Lack of Awareness</td>\n                        <td width=\"7%\">WA</td>\n\t\t</tr>\n<tr>\n\t\t\t<td>May affect safe operation of WTG /\noperating personnel, Requires repair / attention</td>\n                        <td><font color=\"orange\">Significant</font></td> \n                        <td>Previous pendency</td>\n                        <td>PP</td>\n\t\t</tr>\n<tr>\n\t\t\t<td>Not affecting safe operation of WTG, Functionality\nmay be paralysed, Repair work can be done in next\nmaintenance</td>\n                        <td><font color=\"yellow\">Moderate</font></td> \n                        <td>Material defect or Process deficiency</td>\n                        <td>MP</td>\n\t\t</tr>\n<tr>\n\t\t\t<td>No direct impact on WTG safety and functionality</td>\n                        <td><font color=\"green\">Acceptable</font></td> \n                        <td>Design or Reliability</td>\n                        <td>DR</td>\n\t\t</tr>\n        </tbody>\n</table>\n\n<h2>Visual Inspection Details</h2>\n<table class=\"table table-bordered\">\n\t<thead>\n\t\t<tr>\n\t\t\t<th><strong>WTG Part</strong></th>\n\t\t\t<th><strong>Check Code</strong></th>\n\t\t\t<th><strong>Observation</strong></th>\n                        <th><strong>Severity</strong></th>\n                        <th><strong>A\u2019ble cause</strong></th>\n                        <th><strong>Pictorial number</strong></th>\n\t\t</tr>\n</thead>\n<tbody>\n    \n    \n{%- for abc  in frappe.get_list(doctype=\"TCA Data\", fields = [\"section_name\",\"wtg_check_point\",\"comentory\",\"severity\",\"attributable_cause\",\"upload_image\"],filters = {\"tca_activity\":doc.name,\"wtg_name\":doc.wtg_name},order_by = \"section_name\")  -%}\n<tr>\n<th>{{abc[\"section_name\"]}}</th>\n<td>{{abc[\"wtg_check_point\"]}}</td>\n<td>{{abc[\"comentory\"]}}</td>\n<td>{{abc[\"severity\"]}}</td>\n<td>{{abc[\"attributable_cause\"]}}</td>\n<td>\n    {% if abc['upload_image'] != None %}\n    {{abc[\"upload_image\"].split('/')[2].split('.')[0] }}\n{% else %}\n{{abc[\"upload_image\"] }}\n {% endif %}\n\n</td>\n</tr>\n{%- endfor -%}\n        </tbody>\n</table>\n<div class=\"row other-pages\"></div>\n<h2>Visual Inspection Conclusion / Recommendation:</h2>\n<p>The summarisation of collective technical observations of various sections of turbines made in the audit is as\nfollows.</p>\n{% set severe = [] %}\n{% set critical = [] %}\n{% set moderate = [] %}\n{% set acceptable = [] %}\n{% for item in frappe.get_all(\"TCA Data\", {\"tca_activity\":doc.name,\"wtg_name\":doc.wtg_name}, \"severity\") %} \n    {% if item['severity'] == \"Severe\" %}\n        {% if severe.append('1') %}{% endif %}\n    {% endif %}\n\n\n {% if item['severity'] == \"Critical\" %}\n        {% if critical.append('1') %}{% endif %}\n    {% endif %}\n\n\n {% if item['severity'] == \"Moderate\" %}\n        {% if moderate.append('1') %}{% endif %}\n    {% endif %}\n\n {% if item['severity'] == \"Acceptable\" %}\n        {% if acceptable.append('1') %}{% endif %}\n    {% endif %}\n {% endfor %}\n\n\n<table class=\"table table-bordered\">\n\t<tbody>\n\t\t<tr>    <th>Sr. No</th>\n\t\t\t<th><strong>Technical Observations - Severity</strong></th>\n\t\t\t<th><strong>Count</strong></th>\n\t\t\t<th><strong>Percentage (%)</strong></th>\n\t\t</tr>\n<tr>\n<td>1</td>\n<td>Critical category</td>\n<td>{{critical|length}}</td>\n<td>{{((critical|length*100)/(critical|length+severe|length+moderate|length+acceptable|length))|round|int}} %</td>\n</tr>\n<tr>\n<td>2</td>\n<td>Significant category</td>\n<td>{{severe|length}}</td>\n<td>{{((severe|length*100)/(critical|length+severe|length+moderate|length+acceptable|length))|round|int}} %</td>\n</tr>\n<tr>\n<td>3</td>\n<td>Moderate category</td>\n<td>{{moderate|length}}</td>\n<td>{{((moderate|length*100)/(critical|length+severe|length+moderate|length+acceptable|length))|round|int}}  %</td>\n</tr>\n<tr>\n<td>4</td>\n<td>Acceptable category</td>\n<td>{{acceptable|length}}</td>\n<td>{{((acceptable|length*100)/(critical|length+severe|length+moderate|length+acceptable|length))|round|int}}%</td>\n</tr>\n<tr>\n<td></td>\n<td>Total</td>\n<td>{{critical|length+severe|length+moderate|length+acceptable|length}}</td>\n<td>{{((critical|length*100)/(critical|length+severe|length+moderate|length+acceptable|length)+(severe|length*100)/(critical|length+severe|length+moderate|length+acceptable|length) + (moderate|length*100)/(critical|length+severe|length+moderate|length+acceptable|length)  +(acceptable|length*100)/(critical|length+severe|length+moderate|length+acceptable|length))|round|int}} %</td>\n</tr>\n        </tbody>\n</table>\n\n<h5>Based on the above technical diligence it is understood that; Critical & Significant observations together have a\nmagnitude of {{((critical|length*100)/(critical|length+severe|length+moderate|length+acceptable|length)+(severe|length*100)/(critical|length+severe|length+moderate|length+acceptable|length))|round|int}} % among the total observations, and that they are affecting Safety & Functionality of the turbine.</h5><br/>\n<h5>The categorization based on \u2018Attributable cause\u2019 of all the above observation are as follows:</h5>\n\n<table class=\"table table-bordered\">\n\t<tbody>\n\t\t<tr>    <th>Sr. No</th>\n\t\t\t<th><strong>Technical Observations \u2013 Attributable Cause</strong></th>\n\t\t\t<th><strong>Count</strong></th>\n\t\t\t<th><strong>Percentage (%)</strong></th>\n\t\t</tr>\n\n{% set total = [] %}\n{% set wa = [] %}\n{% set pp = [] %}\n{% set mp = [] %}\n{% set dr = [] %}\n\n{% for item in frappe.get_all(\"TCA Data\", {\"tca_activity\":doc.name,\"wtg_name\":doc.wtg_name}, \"attributable_cause\") %} \n    {% if item['attributable_cause'] == \"WA\" %}\n        {% if wa.append('1') %}{% endif %}\n    {% endif %}\n\n\n {% if item['attributable_cause'] == \"PP\" %}\n        {% if pp.append('1') %}{% endif %}\n    {% endif %}\n\n\n {% if item['attributable_cause'] == \"MP\" %}\n        {% if mp.append('1') %}{% endif %}\n    {% endif %}\n\n {% if item['attributable_cause'] == \"DR\" %}\n        {% if dr.append('1') %}{% endif %}\n    {% endif %}\n {% endfor %}\n\n\n<tr>\n<td>1</td>\n<td>Workmanship & Lack of Awareness</td>\n<td>{{wa|length}}</td>\n<td>{{((wa|length*100)/(wa|length+pp|length+mp|length+dr|length))|round|int}} %</td>\n</tr>\n<tr>\n<td>2</td>\n<td>Material Shortage & Process deficiency</td>\n<td>{{mp|length}}</td>\n<td>{{((mp|length*100)/(wa|length+pp|length+mp|length+dr|length))|round|int}} %</td>\n</tr>\n<tr>\n<td>3</td>\n<td>Previous Pendency</td>\n<td>{{pp|length}}</td>\n<td>{{((pp|length*100)/(wa|length+pp|length+mp|length+dr|length))|round|int}} %</td>\n</tr>\n<tr>\n<td>4</td>\n<td>Design or Reliability</td>\n<td>{{dr|length}}</td>\n<td>{{((dr|length*100)/(wa|length+pp|length+mp|length+dr|length))|round|int}} %</td>\n</tr>\n<tr>\n<td></td>\n<td>Total</td>\n<td>{{wa|length+pp|length+mp|length+dr|length}}</td>\n<td>{{(((wa|length*100)/(wa|length+pp|length+mp|length+dr|length))|round|int)+(((mp|length*100)/(wa|length+pp|length+mp|length+dr|length))|round|int)+(((pp|length*100)/(wa|length+pp|length+mp|length+dr|length))|round|int)+(((dr|length*100)/(wa|length+pp|length+mp|length+dr|length))|round|int)}} %</td>\n</tr>\n</tbody>\n</table>\n\n<p>It is observed that {{((mp|length*100)/(wa|length+pp|length+mp|length+dr|length))|round|int}} % of the observations are only because of non-availability of materials & {{((wa|length*100)/(wa|length+pp|length+mp|length+dr|length))|round|int}} % are because of\nlack of awareness & workmanship.</p>\n<div class=\"row other-pages\"></div>\n<h3>Recommendation:</h3>\n\n<p>\n{{doc.recommendation}}</p>\n\n\n<h3>Pictorial References</h3>\n<table class=\"table table-bordered\" width=\"100%\">\n\t<tbody>\n{%- for abc  in  frappe.get_list(doctype=\"TCA Data\", fields = [\"upload_image\",\"upload_image\",\"comentory\"],filters = {\"tca_activity\":doc.name,\"wtg_name\":doc.wtg_name},order_by = \"section_name\") -%}\n\n{% if abc['upload_image'] != None %}\n\n<tr>\n<td width=\"30%\"><img src=\"{{abc['upload_image']}}\" width=\"150px\" height=\"150px\"></td>\n<td align=\"center\"><h4>{{abc[\"upload_image\"].split('/')[2].split('.')[0] }}</h4></td>\n<td width=\"45%\">{{abc[\"comentory\"]}}</td>\n</tr>\n{% endif %}\n{%- endfor -%}\n        </tbody>\n</table>\n<div>\n<div class=\"row other-pages\"></div>\n    <div id=\"footer-html\" class=\"visible-pdf\">\n        {% if not no_letterhead and footer %}\n        <div class=\"letter-head-footer\">\n         TCA Data\n        </div>\n        {% endif %}\n        <p class=\"text-center small page-number visible-pdf\">\n           Visual Impressions \u2013 THC Report: {{ doc.wtg_name }}     &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n {{doc.reference_number}} - {{ _(\"Page {0} of {1}\").format('<span class=\"page\"></span>', '<span class=\"topage\"></span>') }}\n        </p>\n    </div>",
 "idx": 0,
 "line_breaks": 0,
 "modified": "2020-05-12 10:32:01.081008",
 "modified_by": "Administrator",
 "module": "TCA",
 "name": "TCA Activity",
 "owner": "Administrator",
 "print_format_builder": 0,
 "print_format_type": "Jinja",
 "raw_printing": 0,
 "show_section_headings": 0,
 "standard": "Yes"
}